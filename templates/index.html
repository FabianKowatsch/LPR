<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>License Plate Recognition</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.8.1/font/bootstrap-icons.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}" />

  <script src="{{ url_for('static', filename='index.js') }}"></script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js"></script>
</head>

<body class="custom-body">
  <div id="uploadContainer" class="container mt-5">

    <div class="upload-form">
      <h2 class="text-center mb-4">Upload File or Choose Example</h2>
      <!-- File Input -->
      <div class="mb-3">
        <label for="fileInput" class="form-label">Upload Image or Video:</label>
        <span class="text-muted" data-bs-toggle="tooltip" data-bs-placement="right" title="Supported formats: images (png, jpg, jpeg) and videos (mp4, avi, mkv). Max file size: 10 MB.">
        <i class="bi bi-info-circle" style="color: white;"></i>
        </span>
        <input type="file" class="form-control" id="fileInput" name="file" accept="image/*,video/*" />
      </div>

        <!-- Example Image Previews -->
        <div class="example-preview">
          <img src="{{ url_for('static', filename='examples/example1.png') }}" class="example-img"
            data-filename="example1.png" onclick="selectExample(this)" alt="Example 1" />
          <img src="{{ url_for('static', filename='examples/example2.png') }}" class="example-img"
            data-filename="example2.png" onclick="selectExample(this)" alt="Example 2" />
          <img src="{{ url_for('static', filename='examples/example3.png') }}" class="example-img"
            data-filename="example3.png" onclick="selectExample(this)" alt="Example 3" />
        </div>

        <!-- Example Files Selection -->
        <input type="hidden" id="exampleSelect" name="example" />

        <!-- Choose Recognizer Dropdown -->
        <div class="mb-3">
          <label for="recognizerSelect" class="form-label">Choose Recognizer:</label>
          <select class="form-select" id="recognizerSelect" name="recognizer" required>
            <option value="" selected disabled>Select a recognizer</option>
            <option value="parseq">Parseq</option>
            <option value="easyocr">EasyOCR</option>
            <option value="tesseract">Tesseract</option>
          </select>
        </div>

        <!-- Frame Interval Input -->
        <div class="mb-3 d-none" id="frameIntervalContainer">
          <label for="frameInterval" class="form-label">Frame Interval for Video Recognition:</label>
          <input type="number" class="form-control" id="frameInterval" name="frameInterval" value="1" min="1" />
        </div>

        <!-- Submit Button -->
        <button class="btn btn-success w-100" onclick="runInference()">
          Run Inference
        </button>
        <p id="errorMessage" class="error-message d-none">
          Please upload a file or choose an example, and select a recognizer to proceed.
        </p>
    </div>
  </div>

  <!-- Progress Bar -->
  <div id="progressContainer" class="container mt-3" style="display: none;">
    <div class="progress">
      <div id="progressBar" class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
    </div>
  </div>

  <div id="resultContainer" class="result-container" style="display: none;">
    <div id="imageContainer" class="image-container"></div>
    <div id="resultsList" class="results-list"></div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))
      var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
        return new bootstrap.Tooltip(tooltipTriggerEl)
      })
    });

    document.addEventListener('DOMContentLoaded', function() {
      const fileInput = document.getElementById('fileInput');
      const frameIntervalContainer = document.getElementById('frameIntervalContainer');

      fileInput.addEventListener('change', function() {
        const file = this.files[0];
        
        if (file && file.type.startsWith('video/')) {
          frameIntervalContainer.classList.remove('d-none');
        } else {
          frameIntervalContainer.classList.add('d-none');
          // Optional: Wert zur√ºcksetzen
          document.getElementById('frameInterval').value = 1;
        }
      });
    });
  </script>
</html>